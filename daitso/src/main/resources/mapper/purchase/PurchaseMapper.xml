<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.daitso.purchase.repository.IPurchaseRepository">

<select id="selectAllProductNM" resultType="com.example.daitso.purchase.model.PurchaseCheck">
	SELECT product_nm  AS	"productName"	
	  FROM product p,  purchase pur
	 WHERE p.product_id=pur.product_id 
	   AND pur.customer_id=102
</select>

<select id="selectAllPurchase" resultType="com.example.daitso.purchase.model.Purchase">
	SELECT purchase_count	AS	"purchaseCount",
		   purchase_price	AS	"purchasePrice",
		   purchase_DV		AS	"purchaseDv",
		   purchase_count * purchase_price AS "totalCost"
   	  FROM purchase
   	 WHERE customer_id=102
</select>



<select id="selectAllPurchaseList" resultType="com.example.daitso.purchase.model.PurchaseList">
    SELECT p.purchase_id     AS  "purchaseId",
           r.product_nm      AS  "productNm",
           c.customer_nm     AS  "customerNm",
	       p.purchase_num	 AS  "purchaseNum",
	       p.create_dt       AS  "createDt",
           d.common_code_id  AS  "commonCodeId",
           d.common_code_nm  AS  "commonCodeNm"
      FROM purchase p
	  JOIN customer c ON p.customer_id = c.customer_id 
      JOIN common_code d ON p.purchase_dv = d.common_code_id
      JOIN product r ON r.product_id = p.product_id
  ORDER BY p.create_dt
<!-- 	 WHERE purchase_dv = #{purchaseDv} -->
</select>

<update id="changePurchaseStatus" parameterType="com.example.daitso.purchase.model.PurchaseList">
    UPDATE purchase
       SET purchase_dv = #{commonCodeId}
     WHERE purchase_id = #{purchaseId}
</update>

</mapper>