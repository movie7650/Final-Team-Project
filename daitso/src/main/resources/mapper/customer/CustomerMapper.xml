<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.daitso.customer.repository.ICustomerRepository">

	<!-- 이메일 중복체크(중복되면 1, 중복되지 않으면 0 -->
	<select id="checkEmailDuplicated" parameterType="String" resultType="int">
		select count(*)
		from customer
		where customer_email = #{customerEmail}
    </select>
    
    <!-- 휴대폰번호 중복체크(중복되면 1, 중복되지 않으면 0 -->
	<select id="checkTelnoDuplicated" parameterType="String" resultType="int">
        <![CDATA[
		select count(*)
		from customer
		where customer_telno = #{customerTelno}
		]]>
    </select>
    
    
   	<!-- 회원가입 -->
    <insert id="insertIntoCustomer" parameterType="com.example.daitso.customer.model.CustomerSignUp">
    	<![CDATA[
	        INSERT INTO
	        	customer ( customer_id, customer_email, customer_pw, customer_nm, customer_telno, customer_dv )
	        VALUES
        	( customer_seq.nextval, #{customerEmail}, #{customerPw}, #{customerNm}, #{customerTelno}, 101)
        ]]>
    </insert>
    
    <!-- 로그인 -->
    <select id="findByCustomerEmail" parameterType="String" resultType="com.example.daitso.customer.model.CustomerSecurity">
	    SELECT customer_id as customerId, customer_email as customerEmail, 
			   customer_pw as customerPw, customer_nm as customerNm, customer_telno as customerTelno
		  FROM customer
		 WHERE customer_email = #{customerEmail}
    </select>
    
    <!-- 사용자 고유번호로부터 사용자 이름 갖고오기 -->
    <select id="getCustomerNmByCustomerId" parameterType="int" resultType="com.example.daitso.customer.model.CustomerName">
        <![CDATA[
		select customer_nm as customerNm
		from customer
		where customer_id = #{customerId}
		]]>
    </select>
</mapper>