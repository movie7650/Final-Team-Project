<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/include/bs-header :: bsHeader}"></head>
<link rel="stylesheet" th:href="@{/css/admin-css/admin-product.css}">
<link rel="stylesheet" th:href="@{/css/admin-css/admin-frame.css}">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
	<div th:replace="~{/include/admin-body-header :: adminBodyHeader}"></div>
	<div th:replace="~{/include/admin-frame :: adminFrame}"></div>
	<div id="table">

		<div class="row">

			<!-- 일일, 주간, 월별 메출 통계  -->
			<div class="col-lg-6">
				<div class="card">
					 <div class="filter dropdown">
						<a class="icon dropdown-toggle" href="#" id="filterDropdown"
							data-bs-toggle="dropdown" aria-expanded="false"> <i
							class="bi bi-three-dots"></i>
						</a>
						<ul class="dropdown-menu" aria-labelledby="filterDropdown">
							<li class="dropdown-header">
								<h6>Filter</h6>
							</li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueToday">일일</a></li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueThisMonth">주간</a></li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueThisYear">월별</a></li>
						</ul>
					</div>

					<div class="card-body">
						<div class="card-header">매출 현황 (주문건수, 매출액)</div>
						<canvas id="revenueChart"
							style="max-height: 400px; display: block; box-sizing: border-box; height: 210px; width: 421px;"
							width="631" height="316">
                   		 </canvas>
					</div>
				</div>
			</div>


			<!-- 일일, 주간, 월별 인기 상품 통계  -->
			<div class="col-lg-6">
				<div class="card">
					<div class="filter dropdown">
						<a class="icon dropdown-toggle" href="#" id="filterDropdown"
							data-bs-toggle="dropdown" aria-expanded="false"> <i
							class="bi bi-three-dots"></i>
						</a>
						<ul class="dropdown-menu" aria-labelledby="filterDropdown">
							<li class="dropdown-header">
								<h6>Filter</h6>
							</li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueToday">일일</a></li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueThisMonth">주간</a></li>
							<li><a class="dropdown-item" href="#"
								id="filterRevenueThisYear">월별</a></li>
						</ul>
					</div>

					<div class="card-body">
						<div class="card-header">가장 많이 팔린 상품</div>
						<canvas id="topSellingChart"
							style="max-height: 400px; display: block; box-sizing: border-box; height: 210px; width: 421px;"
							width="631" height="316"></canvas>
					</div>
				</div>
			</div>

			<!-- 재고 현황 조회  -->
			<div class="col-lg-6">
				<div class="card">
					<div class="card-body">
						<div class="card-header">재고 현황 (부족한 항목)</div>
						<canvas id="lowStockChart"
							style="max-height: 300px; display: block; box-sizing: border-box; height: 210px; width: 300px;"
							width="300" height="210">
						</canvas>
					</div>
				</div>
			</div>


		</div>

		<!--  -->
	</div>
	</div>
	</div>

	<div th:replace="~{/include/footer :: footer}"></div>
	<!-- Chart.js 라이브러리 추가 -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<script th:inline="javascript">
	
	document.addEventListener("DOMContentLoaded", () => {
	    var revenueCtx = document.getElementById('revenueChart').getContext('2d');
	    var dates = /*[[${dates}]]*/ []; // Thymeleaf 변수를 JavaScript 변수로 가져옴
	    var orderCounts = /*[[${orderCounts}]]*/ []; // Thymeleaf 변수를 JavaScript 변수로 가져옴
	    var revenueData = /*[[${revenueData}]]*/ []; // Thymeleaf 변수를 JavaScript 변수로 가져옴

	    
	    var revenueChart = new Chart(revenueCtx, {
	        type: 'line',
	        data: {
	            labels: dates,
	            datasets: [{
	                label: '주문건수',
	                data: orderCounts,
	                fill: false,
	                borderColor: 'rgb(75, 192, 192)',
	                tension: 0.1
	            }, {
	                label: '매출액',
	                data: revenueData,
	                fill: false,
	                borderColor: 'rgb(255, 99, 132)',
	                tension: 0.1
	            }]
	        },
	        options: {
	            scales: {
	                y: {
	                    beginAtZero: true,
	                    ticks: {
	                        callback: function (value, index, values) {
	                            if (value >= 1000000) {
	                                return (value / 1000000).toFixed(1) + 'M';
	                            } else if (value >= 1000) {
	                                return (value / 1000).toFixed(1) + 'K';
	                            } else {
	                                return value;
	                            }
	                        }
	                    }
	                }
	            }
	        }
	    });
	});

        
        var productNames = ['나이키신발', '아디다스 저지', '조거 바지', '사랑의 기술', '아이폰'];
        var salesData = [100, 78, 50, 35, 20];

        // 차트 생성 - 가장 많이 팔린 상품
        var topSellingCtx = document.getElementById('topSellingChart').getContext('2d');
        var topSellingChart = new Chart(topSellingCtx, {
            type: 'bar',
            data: {
                labels: productNames,
                datasets: [{
                    label: '판매량',
                    data: salesData,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgb(75, 192, 192)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        
            
 	// 예시 데이터
    var inventoryData = [
      { category: "의류", stock: 15 },
      { category: "신발", stock: 8 },
      { category: "액세서리", stock: 30 },
      { category: "가방", stock: 11 },
    ];

    // 재고 부족 기준 (예: 100개 미만)
    var stockThreshold = 100;

    // 재고 부족한 항목 필터링
    var lowStockItems = inventoryData.filter(function(item) {
      return item.stock < stockThreshold;
    });

    // 재고 부족한 항목만을 담는 배열
    var lowStockCategories = lowStockItems.map(function(item) {
      return item.category;
    });

    // 파이 차트 데이터 생성
    var pieChartData = {
      labels: lowStockCategories,
      datasets: [
        {
          data: lowStockItems.map(function(item) {
            return item.stock;
          }),
          backgroundColor: [
            'red', // 재고 부족한 항목은 빨간색으로 표시
            'red',
            'red',
            'red',
          ],
        },
      ],
    };

    // 파이 차트 생성
    var pieChartCtx = document.getElementById('lowStockChart').getContext('2d');
    var lowStockChart = new Chart(pieChartCtx, {
      type: 'pie',
      data: pieChartData,
    });

    
    
 /* 	// 필터를 선택할 때의 동작을 정의합니다.
    document.getElementById('filterRevenueToday').addEventListener('click', function () {
        // 여기에 필터 적용 코드를 작성합니다.
        // revenueChart 차트의 데이터를 변경하고 업데이트합니다.
           // "Today" 필터가 선택되었을 때의 동작을 정의합니다.
    // 여기에서 예시 데이터를 오늘의 데이터로 업데이트하고 차트를 업데이트합니다.
    var todayOrderCounts = [5, 10, 3, 8, 15]; // 오늘의 주문 수 데이터
    var todayRevenueData = [1000000, 450000, 300000, 20000, 30000]; // 오늘의 매출 데이터

    // 차트 데이터 업데이트
    revenueChart.data.datasets[0].data = todayOrderCounts;
    revenueChart.data.datasets[1].data = todayRevenueData;
    revenueChart.update(); // 차트 업데이트
    });

    document.getElementById('filterTopSellingThisWeek').addEventListener('click', function () {
        // 여기에 필터 적용 코드를 작성합니다.
        // revenueChart 차트의 데이터를 변경하고 업데이트합니다.
        // "This Month" 필터가 선택되었을 때의 동작을 정의합니다.
    // 여기에서 예시 데이터를 이번 달 데이터로 업데이트하고 차트를 업데이트합니다.
    var thisWeekOrderCounts = [80, 120, 90, 110, 150]; // 이번 달 주문 수 데이터
    var thisWeekRevenueData = [15000000, 22000000, 18000000, 2000000, 2500000]; // 이번 달 매출 데이터

    // 차트 데이터 업데이트
    revenueChart.data.datasets[0].data = thisWeekOrderCounts;
    revenueChart.data.datasets[1].data = thisWeekRevenueData;
    revenueChart.update(); // 차트 업데이트
    });

    document.getElementById('filterTopSellingThisMonth').addEventListener('click', function () {
    	 // "This Year" 필터가 선택되었을 때의 동작을 정의합니다.
        // 여기에서 예시 데이터를 금년 데이터로 업데이트하고 차트를 업데이트합니다.
        var thisMonthOrderCounts = [500, 800, 700, 900, 1000]; // 금년 주문 수 데이터
        var thisMonthRevenueData = [80000000, 120000000, 110000000, 15000000, 18000000]; // 금년 매출 데이터

        // 차트 데이터 업데이트
        revenueChart.data.datasets[0].data = thisMonthOrderCounts;
        revenueChart.data.datasets[1].data = thisMonthRevenueData;
        revenueChart.update(); // 차트 업데이트
    });

    document.getElementById('filterTopSellingToday').addEventListener('click', function () {
        // 여기에 필터 적용 코드를 작성합니다.
        // topSellingChart 차트의 데이터를 변경하고 업데이트합니다.
    });

    document.getElementById('filterTopSellingThisWeek').addEventListener('click', function () {
        // 여기에 필터 적용 코드를 작성합니다.
        // topSellingChart 차트의 데이터를 변경하고 업데이트합니다.
    });

    document.getElementById('filterTopSellingThisMonth').addEventListener('click', function () {
        // 여기에 필터 적용 코드를 작성합니다.
        // topSellingChart 차트의 데이터를 변경하고 업데이트합니다.
    }); */
</script>

</body>
</html>
