<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/include/header :: header}">
</head>
<body>
	<div th:replace="~{/include/body-header :: bodyHeader}"></div>
	<div th:replace="~{/include/mypage-bread-board :: mypageBreadBoard}"></div>
	
<div class="review-main">
<div th:replace="~{/include/mypage-bread-board :: mypageBreadBoard01}"></div>
	 <div class="title-review">내 리뷰</div>
	 <div style="margin-top:10px; margin-right:8px;">
		 	<div th:if="${reviewcontentcount} != 0" style="margin-top:90px; margin-left:-45px;">
		 		<table class="mypage-review-table">
		 			<tr>
						<th>상품정보</th>
						<th>리뷰제목</th>
						<th>리뷰작성일자</th>
						<th>기능</th>
					</tr>
			 		<tr style="font-size: 80%;" th:each="mypageReview : ${mypageReviewList}"> 
			 			<td>
			 				<div class="my-review-product-img"><img style="width:100%; height:100%;" th:src="${mypageReview.productImg}"></div>
							<div th:text="${mypageReview.productNm}" class="my-review-productNm">남성무지반팔티</div>
						</td>
						<td>
							<div>[(${mypageReview.reviewTitle})]</div>
						</td>
			 			<td th:text="${mypageReview.createDt}">리뷰작성일자</td>
			 			<td>
			 				<div style="border:solid 1px white; padding-top:20px;">
		 						<input type="button" id="show-review" th:onclick="new_window([[${mypageReview.reviewId}]]);" value="리뷰보기"><br>
		 						<input class="review-id" type="hidden" name="reviewId" th:value="${mypageReview.reviewId}">
								<button type="button" th:id="${mypageReview.reviewId}" class="mypage-inquiry-delete" th:onclick="removeCheck([[${mypageReview.reviewId}]])">삭제</button>
		 					</div>
		 				</td>
			 		</tr>
		 		</table>
			</div>
			<div th:if="${reviewcontentcount}==0" class="none-review">
				<div style="background-color: #f3f3f3; margin-bottom:50px; text-align:center; width:889px; margin-left:-42px; margin-top:100px; height: 545px;">
					<div style="font-weight:600; font-size: 30px; padding-top:170px;">작성한 <span style="color:#39594e;">리뷰</span>가 없습니다.<br><span style="color:#e8c369;">상품</span>을 구매해 주세요.</div>
					<button id="goto-order-button" onclick="location.href='/'">구매하러가기</button>
				</div>
			</div> 
	 </div>	
</div><!-- review-main -->

<div th:if="${reviewcontentcount}!=0" style="display:flex; justify-content: center;">
<nav  aria-label="Page navigation">
<ul class="pagination01">
	<li th:if="${nowPageBlock>1}">
		<a th:href="@{/mypage/review (page=__${startPage-1}__)}" aria-label="Previous">◀</a>
	</li>

	<li th:onclick ="|location.href='@{/mypage/review (page=__${i}__)}'|"
		th:each="i: ${#numbers.sequence(startPage, endPage)}" th:classappend="${i==nowPage}?active">
		<a th:href="@{/mypage/review (page=__${i}__)}">[[${i}]]</a>		
	</li>
	
	<li th:if="${nowPageBlock<totalPageBlock}">
		<a th:href="@{/mypage/review (page=__${endPage+1}__)}" aria-label="Next">▶</a>
	</li>
</ul>
</nav>
</div>


	<div th:replace="~{/include/footer :: footer}"></div>
<script>
const csrtToken = '[[${_csrf.token}]]';
function new_window(item) {
	window.open("/mypage/mydetailreview/" + item, "Child",
			"width=870, height=740, top=50, left=350");
}
function removeCheck(reviewId) {
	if (confirm("정말 삭제하시겠습니까??") == true) { //확인
		fetch( window.location.origin + "/mypage/delete/review/" + reviewId ,{
			method: "POST",
			headers:{
				"Content-Type": "application/json",
				"X-CSRF-TOKEN": csrtToken
			},	
		})
		.then((response) => response.json())
		.then((data) => window.location.reload())
	} 
}
	
</script>
</body>
<script th:src="@{/js/mic.js}"></script>
</html>